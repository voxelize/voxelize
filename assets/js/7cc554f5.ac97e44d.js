"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7905],{29727:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"basics/handle-the-network","title":"Handle the Network","description":"The network manager connects to the server over WebSockets and handles all game data.","source":"@site/docs/tutorials/basics/7-handle-the-network.md","sourceDirName":"basics","slug":"/basics/handle-the-network","permalink":"/tutorials/basics/handle-the-network","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Create the Client","permalink":"/tutorials/basics/create-the-client"},"next":{"title":"Initialize the World","permalink":"/tutorials/basics/initialize-the-world"}}');var i=t(62540),a=t(43023);const o={sidebar_position:7},s="Handle the Network",d={},l=[{value:"Create the Network",id:"create-the-network",level:2},{value:"Connect to the Server",id:"connect-to-the-server",level:2},{value:"Add the Render Loop",id:"add-the-render-loop",level:2},{value:"Full Code So Far",id:"full-code-so-far",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"handle-the-network",children:"Handle the Network"})}),"\n",(0,i.jsx)(n.p,{children:"The network manager connects to the server over WebSockets and handles all game data."}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart LR\n    subgraph Client["Client"]\n        W[World]\n        P[Peers]\n        E[Entities]\n        N[Network]\n    end\n\n    subgraph Server["Voxelize Server"]\n        WS[WebSocket]\n    end\n\n    N --\x3e|register| W\n    N --\x3e|register| P\n    N --\x3e|register| E\n    N <--\x3e|chunks, updates, events| WS\n\n    style N fill:#4a9eff,stroke:#2563eb,stroke-width:3px\n    style WS fill:#f59e0b,stroke:#d97706,stroke-width:2px'}),"\n",(0,i.jsx)(n.h2,{id:"create-the-network",children:"Create the Network"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:'title="main.js"',children:"const network = new VOXELIZE.Network();\nnetwork.register(world);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Registering the world lets it receive chunk data and world updates."}),"\n",(0,i.jsx)(n.h2,{id:"connect-to-the-server",children:"Connect to the Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:'title="main.js"',children:'async function start() {\n  await network.connect("http://localhost:4000");\n  await network.join("tutorial");\n\n  await world.initialize();\n}\n\nstart();\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"connect"})," - Establishes WebSocket connection"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"join"}),' - Enters the "tutorial" world']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"initialize"})," - Processes world config and starts chunk loading"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"network.connect"})," automatically converts ",(0,i.jsx)(n.code,{children:"http://"})," to ",(0,i.jsx)(n.code,{children:"ws://"})," (or ",(0,i.jsx)(n.code,{children:"wss://"})," for HTTPS)."]})}),"\n",(0,i.jsx)(n.h2,{id:"add-the-render-loop",children:"Add the Render Loop"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:'title="main.js"',children:'function animate() {\n  requestAnimationFrame(animate);\n  renderer.render(world, camera);\n}\n\nasync function start() {\n  animate();\n\n  await network.connect("http://localhost:4000");\n  await network.join("tutorial");\n  await world.initialize();\n}\n\nstart();\n'})}),"\n",(0,i.jsx)(n.h2,{id:"full-code-so-far",children:"Full Code So Far"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:'title="main.js"',children:'import * as VOXELIZE from "@voxelize/core";\nimport * as THREE from "three";\n\nconst canvas = document.getElementById("canvas");\n\nconst world = new VOXELIZE.World({\n  textureUnitDimension: 16,\n});\n\nconst camera = new THREE.PerspectiveCamera(\n  75,\n  window.innerWidth / window.innerHeight,\n  0.1,\n  3000\n);\n\nconst renderer = new THREE.WebGLRenderer({\n  antialias: true,\n  powerPreference: "high-performance",\n  canvas,\n});\nrenderer.setSize(window.innerWidth, window.innerHeight);\nrenderer.setPixelRatio(window.devicePixelRatio || 1);\nrenderer.outputColorSpace = THREE.SRGBColorSpace;\n\nwindow.addEventListener("resize", () => {\n  camera.aspect = window.innerWidth / window.innerHeight;\n  camera.updateProjectionMatrix();\n  renderer.setSize(window.innerWidth, window.innerHeight);\n});\n\nconst network = new VOXELIZE.Network();\nnetwork.register(world);\n\nfunction animate() {\n  requestAnimationFrame(animate);\n  renderer.render(world, camera);\n}\n\nasync function start() {\n  animate();\n\n  await network.connect("http://localhost:4000");\n  await network.join("tutorial");\n\n  await world.initialize();\n}\n\nstart();\n'})}),"\n",(0,i.jsx)(n.p,{children:"Run the client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm run dev\n"})}),"\n",(0,i.jsx)(n.p,{children:"You should see an empty sky with clouds. The world is initialized but we haven't told it what to render yet."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var r=t(63696);const i={},a=r.createContext(i);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);