"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6758],{42400:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"networking/calling-methods","title":"Calling Methods","description":"Methods are RPC calls from client to server. Use them when a client action needs to trigger server-side logic - spawning entities, changing world state, or validating game rules.","source":"@site/docs/wiki/networking/calling-methods.md","sourceDirName":"networking","slug":"/networking/calling-methods","permalink":"/wiki/networking/calling-methods","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Networking","permalink":"/wiki/category/networking"},"next":{"title":"Handling Events","permalink":"/wiki/networking/handling-events"}}');var s=t(62540),r=t(43023);const a={sidebar_position:1},l="Calling Methods",o={},d=[{value:"Example: Spawning a Bot",id:"example-spawning-a-bot",level:2},{value:"Server Setup",id:"server-setup",level:3},{value:"Client Usage",id:"client-usage",level:3},{value:"Example: Setting World Time",id:"example-setting-world-time",level:2},{value:"Full Client Implementation",id:"full-client-implementation",level:2},{value:"Methods vs Events",id:"methods-vs-events",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"calling-methods",children:"Calling Methods"})}),"\n",(0,s.jsx)(n.p,{children:"Methods are RPC calls from client to server. Use them when a client action needs to trigger server-side logic - spawning entities, changing world state, or validating game rules."}),"\n",(0,s.jsx)(n.p,{children:"Unlike events, methods run world-wide and aren't location-based."}),"\n",(0,s.jsx)(n.h2,{id:"example-spawning-a-bot",children:"Example: Spawning a Bot"}),"\n",(0,s.jsx)(n.p,{children:"This example shows a method that spawns a bot entity at a given position."}),"\n",(0,s.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant Client\n    participant Server\n    participant World\n\n    Client->>Server: method.call("spawn-bot", {position})\n    Server->>World: Create bot entity at position\n    World->>Client: Entity CREATE message'}),"\n",(0,s.jsx)(n.h3,{id:"server-setup",children:"Server Setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",metastring:'title="Server Method Handler"',children:'use serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize)]\nstruct SpawnBotPayload {\n    position: [f32; 3],\n}\n\nworld.set_method_handle("spawn-bot", |world, client_id, payload| {\n    let data: SpawnBotPayload = serde_json::from_value(payload)\n        .expect("Failed to parse spawn-bot payload");\n\n    let [x, y, z] = data.position;\n\n    world.spawn_entity("bot", json!({\n        "position": [x, y, z],\n        "direction": [0.0, 0.0, 1.0],\n    }));\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"client-usage",children:"Client Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="Client Method Call"',children:'import * as VOXELIZE from "@voxelize/core";\n\nconst method = new VOXELIZE.Method();\nnetwork.register(method);\n\ninputs.bind("KeyZ", () => {\n  method.call("spawn-bot", {\n    position: controls.object.position.toArray(),\n  });\n});\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-setting-world-time",children:"Example: Setting World Time"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",metastring:'title="Server Time Method"',children:'#[derive(Serialize, Deserialize)]\nstruct TimePayload {\n    time: f64,\n}\n\nworld.set_method_handle("time", |world, _client_id, payload| {\n    let data: TimePayload = serde_json::from_value(payload)\n        .expect("Failed to parse time payload");\n\n    world.stats_mut().set_time(data.time);\n});\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="Client Time Call"',children:'method.call("time", {\n  time: world.options.timePerDay / 2,\n});\n'})}),"\n",(0,s.jsx)(n.h2,{id:"full-client-implementation",children:"Full Client Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="main.ts"',children:'import * as VOXELIZE from "@voxelize/core";\n\nconst network = new VOXELIZE.Network();\nconst method = new VOXELIZE.Method();\n\nnetwork.register(method);\n\nasync function start() {\n  await network.connect("http://localhost:4000");\n  await network.join("tutorial");\n\n  method.call("spawn-bot", { position: [0, 50, 0] });\n}\n\nstart();\n'})}),"\n",(0,s.jsx)(n.h2,{id:"methods-vs-events",children:"Methods vs Events"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Use Case"}),(0,s.jsx)(n.th,{children:"Use"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Client triggers server action"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Method"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Server notifies nearby clients"}),(0,s.jsx)(n.td,{children:"Event"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Location-based broadcasting"}),(0,s.jsx)(n.td,{children:"Event"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"World-wide state changes"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Method"})})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"/wiki/networking/handling-events",children:"Handling Events"})," for the event system."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(63696);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);